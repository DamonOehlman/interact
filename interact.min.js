COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var w=arguments[0]||{},C,h=1,o=arguments.length;h<o;h++)if((C=arguments[h])!==null)for(var k in C){var j=C[k];if(w!==j)if(j!==undefined)w[k]=j}return w};
(function(){function w(h,o){var k=h.obsHandlers;k[o]||(k[o]=[]);return k[o]}var C=0;COG.observable=function(h){if(!h)return null;if(!h.obsHandlers)h.obsHandlers={};if(!(h.bind||h.trigger||h.unbind)){h.bind=function(o,k){var j="callback"+C++;w(h,o).unshift({fn:k,id:j});return j};h.trigger=function(o){var k=w(h,o),j={cancel:false,name:o,tickCount:(new Date).getTime()},m;if(!k)return null;m=Array.prototype.slice.call(arguments,1);h.eventInterceptor&&h.eventInterceptor(o,j,m);m.unshift(j);for(var D=k.length;D--&&
!j.cancel;)k[D].fn.apply(self,m);return j};h.unbind=function(o,k){if(typeof o==="undefined")h.obsHandlers={};else for(var j=w(h,o),m=0;j&&m<j.length;m++)if(j[m].id===k){j.splice(m,1);break}return h}}return h}})();
(function(){function w(j){return typeof console!=="undefined"?function(){console[j](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var C=window.console&&window.console.markTimeline,h=w("error"),o=w("info"),k=function(){return C?function(j,m){console.markTimeline(j+(m?": "+((new Date).getTime()-m)+"ms":""))}:function(){}}();COG.extend(COG,{trace:k,debug:w("debug"),info:o,warn:w("warn"),error:h,exception:function(j){if(h)for(var m in j)o("ERROR DETAIL: "+m+
": "+j[m])}})})();
INTERACT=function(){function w(c){return function(b,d,p){(p?p:c?document.body:document).addEventListener(b,d,false)}}function C(c){return function(b,d,p){(p?p:c?document.body:document).removeEventListener(b,d,false)}}function h(c,b,d){(d?d:document).attachEvent("on"+c,b)}function o(c,b,d){(d?d:document).detachEvent("on"+c,b)}function k(c,b){return{x:c?c:0,y:b?b:0,count:1}}function j(c,b){K.push(COG.extend({handler:null,checks:{},type:c},b))}function m(c){var b=0,d=0;if(c.offsetParent){do{b+=c.offsetLeft;
d+=c.offsetTop;c=c.offsetParent}while(c)}return{x:b,y:d}}function D(c,b){return{x:c.x-(b?b.x:0),y:c.y-(b?b.y:0)}}function M(c){if(c.preventDefault){c.preventDefault();c.stopPropagation()}else c.cancelBubble&&c.cancelBubble()}var K=[],N=function(c,b,d){function p(q,z,x,G){n.trigger("pan",G.x,G.y)}d=COG.extend({binder:null,unbinder:null,observable:null},d);for(var n=d.observable,u=[],r={bind:function(){return n.bind.apply(null,arguments)},pannable:function(q){COG.extend({inertia:true},q);n.bind("pointerMove",
p);return r},unbind:function(){n.unbind();for(var q=0;q<u.length;q++)u[q].unbind();return r}},y=0;y<b.length;y++)u.push(b[y](c,n,d));return r};j("pointer",{handler:function(c,b,d){function p(a){var g=a.target?a.target:a.srcElement;if(x||g&&g===c)if(A=G||a.button===0){g.style.cursor="move";M(a);s=a.pageX?a.pageX:a.screenX;l=a.pageY?a.pageY:a.screenY;F=k(s,l);H=m(c);b.trigger("pointerDown",F,D(F,H))}}function n(a){var g=a.target?a.target:a.srcElement;t=a.pageX?a.pageX:a.screenX;v=a.pageY?a.pageY:a.screenY;
if(A&&(x||g&&g===c))y("pointerMove")}function u(a){var g=a.target?a.target:a.srcElement;if(A&&a.button===0){A=false;if(x||g&&g===c){g.style.cursor="default";y("pointerUp")}}}function r(a){var g=a.target?a.target:a.srcElement;if(x||g&&g===c){g=a.detail?a.axis===2?-a.detail*q:0:a.wheelDeltaY;if(g!==0){var I=k(t,v);b.trigger("zoom",I,D(I,m(c)),g/z);M(a)}}}function y(a){var g=k(t,v);b.trigger(a,g,D(g,H),k(t-s,v-l));s=t;l=v}d=COG.extend({inertia:false},d);var q=120,z=q*8,x=typeof FlashCanvas!="undefined",
G=d.isIE,A=false,F,H,t,v,s,l;d.binder("mousedown",p,false);d.binder("mousemove",n,false);d.binder("mouseup",u,false);d.binder("click",function(a){var g=a.target?a.target:a.srcElement;if(x||g&&g===c){a=k(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("tap",a,D(a,m(c)))}},false);d.binder("dblclick",function(a){var g=a.target?a.target:a.srcElement;if(x||g&&g===c){a=k(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("doubleTap",a,D(a,m(c)))}},false);d.binder("mousewheel",
r,window);d.binder("DOMMouseScroll",r,window);return{unbind:function(){d.unbinder("mousedown",p,false);d.unbinder("mousemove",n,false);d.unbinder("mouseup",u,false);d.unbinder("mousewheel",r,window);d.unbinder("DOMMouseScroll",r,window)}}},checks:{touch:false}});j("pointer",{handler:function(c,b,d){function p(e){if(e.count<2)return 0;var f=e.x-e.next.x;e=e.y-e.next.y;return~~Math.sqrt(f*f+e*e)}function n(e,f,i){f=f?f:0;i=i?i:0;for(var E={x:e.x-f,y:e.y-i,id:e.id,count:e.count},B=E;e.next;){e=e.next;
B=B.next={x:e.x-f,y:e.y-i,id:e.id}}return E}function u(e,f){var i=e[f?f:"touches"],E,B;if(i.length===0)return null;B=E={x:i[0].pageX,y:i[0].pageY,id:i[0].identifier,count:i.length};for(var J=1,O=i.length;J<O;J++)B=B.next={x:i[J].pageX,y:i[J].pageY,id:i[J].identifier};return E}function r(e){var f=e.target?e.target:e.srcElement;if(f&&f===c){t=m(c);f=u(e,"changedTouches");var i=n(f,t.x,t.y);if(!s){v=A;b.trigger("pointerDown",f,i)}I&&b.trigger("pointerDownMulti",f,i);s=u(e);if(s.count>1)a=p(s);L=1;g=
n(s)}}function y(e){var f=e.target?e.target:e.srcElement;if(f&&f===c){e.preventDefault();l=u(e);if(v==A)v=Math.abs(s.x-l.x)>x||Math.abs(s.y-l.y)>x?G:A;if(v!=A){v=l.count>1?H:F;if(v==H)if(s.count===1){s=n(l);a=p(s)}else{e=p(l);if(Math.abs(a-e)<z)v=F;else{f=l.x;var i=l.next.x,E=l.y,B=l.next.y;f={x:(f<i?f:i)+(Math.abs(f-i)>>1),y:(E<B?E:B)+(Math.abs(E-B)>>1)};e=e/a;i=e-L;b.trigger("zoom",f,D(f,t),i);L=e}}v==F&&b.trigger("pointerMove",l,n(l,t.x,t.y),k(l.x-g.x,l.y-g.y));I&&b.trigger("pointerMoveMulti",
l,n(l,t.x,t.y))}g=n(l)}}function q(e){var f=e.target?e.target:e.srcElement;if(f&&f===c){f=u(e,"changedTouches");var i=n(f,t.x,t.y);l=u(e);if(!l){v===A&&b.trigger("pointerTap",f,i);b.trigger("pointerUp",f,i);s=null}I&&b.trigger("pointerUpMulti",f,i)}}d=COG.extend({detailed:false,inertia:false},d);var z=20,x=7,G=0,A=1,F=2,H=3,t,v,s,l,a,g,I=d.detailed,L=1;d.binder("touchstart",r,false);d.binder("touchmove",y,false);d.binder("touchend",q,false);COG.info("initialized touch handler");return{unbind:function(){d.unbinder("touchstart",
r,false);d.unbinder("touchmove",y,false);d.unbinder("touchend",q,false)}}},checks:{touch:true}});return{register:j,watch:function(c,b,d){b=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},b);capabilities=COG.extend({touch:"ontouchstart"in window},d);if(!b.observable){COG.info("creating observable");b.observable=COG.observable({});globalOpts=b}b.binder=b.isIE?h:w(b.bindToBody);b.unbinder=b.isIE?o:C(b.bindToBody);d=b.types;for(var p=capabilities,n=
[],u=K.length;u--;){var r=K[u],y=!d||d.indexOf(r.type)>=0,q=true,z;for(z in r.checks){var x=r.checks[z];COG.info("checking "+z+" capability. require: "+x+", capability = "+p[z]);q=q&&x===p[z]}if(y&&q)n[n.length]=r.handler}return new N(c,n,b)}}}();
