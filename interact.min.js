COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var v=arguments[0]||{},B,g=1,o=arguments.length;g<o;g++)if((B=arguments[g])!==null)for(var j in B){var i=B[j];if(v!==i)if(i!==undefined)v[j]=i}return v};
(function(){function v(g,o){var j=g.obsHandlers;j[o]||(j[o]=[]);return j[o]}var B=0;COG.observable=function(g){if(!g)return null;if(!g.obsHandlers)g.obsHandlers={};if(!(g.bind||g.trigger||g.unbind)){g.bind=function(o,j){var i="callback"+B++;v(g,o).unshift({fn:j,id:i});return i};g.trigger=function(o){var j=v(g,o),i={cancel:false,name:o,tickCount:(new Date).getTime()},l;if(!j)return null;l=Array.prototype.slice.call(arguments,1);g.eventInterceptor&&g.eventInterceptor(o,i,l);l.unshift(i);for(var C=j.length;C--&&
!i.cancel;)j[C].fn.apply(self,l);return i};g.unbind=function(o,j){if(typeof o==="undefined")g.obsHandlers={};else for(var i=v(g,o),l=0;i&&l<i.length;l++)if(i[l].id===j){i.splice(l,1);break}return g}}return g}})();
(function(){function v(i){return typeof console!=="undefined"?function(){console[i](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var B=window.console&&window.console.markTimeline,g=v("error"),o=v("info"),j=function(){return B?function(i,l){console.markTimeline(i+(l?": "+((new Date).getTime()-l)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:v("debug"),info:o,warn:v("warn"),error:g,exception:function(i){if(g)for(var l in i)o("ERROR DETAIL: "+l+
": "+i[l])}})})();
INTERACT=function(){function v(d){return function(b,c,p){(p?p:d?document.body:document).addEventListener(b,c,false)}}function B(d){return function(b,c,p){(p?p:d?document.body:document).removeEventListener(b,c,false)}}function g(d,b,c){(c?c:document).attachEvent("on"+d,b)}function o(d,b,c){(c?c:document).detachEvent("on"+d,b)}function j(d,b){return{x:d?d:0,y:b?b:0,count:1}}function i(d,b){K.push(COG.extend({handler:null,checks:{},type:d},b))}function l(d){var b=0,c=0;if(d.offsetParent){do{b+=d.offsetLeft;
c+=d.offsetTop;d=d.offsetParent}while(d)}return{x:b,y:c}}function C(d,b){return{x:d.x-(b?b.x:0),y:d.y-(b?b.y:0)}}function M(d){if(d.preventDefault){d.preventDefault();d.stopPropagation()}else d.cancelBubble&&d.cancelBubble()}var K=[],N=function(d,b,c){function p(m,x,D,G){n.trigger("pan",G.x,G.y)}c=COG.extend({binder:null,unbinder:null,observable:null},c);for(var n=c.observable,t=[],q={bind:function(){return n.bind.apply(null,arguments)},pannable:function(m){COG.extend({inertia:true},m);n.bind("pointerMove",
p);return q},unbind:function(){n.unbind();for(var m=0;m<t.length;m++)t[m].unbind();return q}},y=0;y<b.length;y++)t.push(b[y](d,n,c));return q};i("pointer",{handler:function(d,b,c){function p(a){if(m(a))if(z=y(a)){d.style.cursor="move";M(a);r=a.pageX?a.pageX:a.screenX;k=a.pageY?a.pageY:a.screenY;F=j(r,k);H=l(d);b.trigger("pointerDown",F,C(F,H))}}function n(a){s=a.pageX?a.pageX:a.screenX;u=a.pageY?a.pageY:a.screenY;z&&m(a)&&x("pointerMove")}function t(a){if(z&&y(a)){z=false;if(m(a)){d.style.cursor=
"default";x("pointerUp")}}}function q(a){if(m(a)){var w;a=a||window.event;if(a.detail)w=a.axis===2?-a.detail*D:0;else{w=a.wheelDeltaY?a.wheelDeltaY:a.wheelDelta;if(window.opera)w=-w}if(w!==0){var I=j(s,u);b.trigger("zoom",I,C(I,l(d)),w/G);M(a);a.returnValue=false}}}function y(a){a=a||window.event;return(a.which||a.button)==1}function m(a){for(a=a.target?a.target:a.srcElement;a&&a.nodeName&&a.nodeName.toUpperCase()!="CANVAS";)a=a.parentNode;return a&&a===d}function x(a){var w=j(s,u);b.trigger(a,w,
C(w,H),j(s-r,u-k));r=s;k=u}c=COG.extend({inertia:false},c);var D=120,G=D*8,z=false,F,H,s,u,r,k;c.binder("mousedown",p,false);c.binder("mousemove",n,false);c.binder("mouseup",t,false);c.binder("click",function(a){if(m(a)){a=j(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("tap",a,C(a,l(d)))}},false);c.binder("dblclick",function(a){COG.info("captured double click");if(m(a)){a=j(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);COG.info("captured double click + target matched");b.trigger("doubleTap",
a,C(a,l(d)))}},false);c.binder("mousewheel",q,document);c.binder("DOMMouseScroll",q,document);return{unbind:function(){c.unbinder("mousedown",p,false);c.unbinder("mousemove",n,false);c.unbinder("mouseup",t,false);c.unbinder("mousewheel",q,document);c.unbinder("DOMMouseScroll",q,document)}}},checks:{touch:false}});i("pointer",{handler:function(d,b,c){function p(e){if(e.count<2)return 0;var f=e.x-e.next.x;e=e.y-e.next.y;return~~Math.sqrt(f*f+e*e)}function n(e,f,h){f=f?f:0;h=h?h:0;for(var E={x:e.x-f,
y:e.y-h,id:e.id,count:e.count},A=E;e.next;){e=e.next;A=A.next={x:e.x-f,y:e.y-h,id:e.id}}return E}function t(e,f){var h=e[f?f:"touches"],E,A;if(h.length===0)return null;A=E={x:h[0].pageX,y:h[0].pageY,id:h[0].identifier,count:h.length};for(var J=1,O=h.length;J<O;J++)A=A.next={x:h[J].pageX,y:h[J].pageY,id:h[J].identifier};return E}function q(e){var f=e.target?e.target:e.srcElement;if(f&&f===d){s=l(d);f=t(e,"changedTouches");var h=n(f,s.x,s.y);if(!r){u=z;b.trigger("pointerDown",f,h)}I&&b.trigger("pointerDownMulti",
f,h);r=t(e);if(r.count>1)a=p(r);L=1;w=n(r)}}function y(e){var f=e.target?e.target:e.srcElement;if(f&&f===d){e.preventDefault();k=t(e);if(u==z)u=Math.abs(r.x-k.x)>D||Math.abs(r.y-k.y)>D?G:z;if(u!=z){u=k.count>1?H:F;if(u==H)if(r.count===1){r=n(k);a=p(r)}else{e=p(k);if(Math.abs(a-e)<x)u=F;else{f=k.x;var h=k.next.x,E=k.y,A=k.next.y;f={x:(f<h?f:h)+(Math.abs(f-h)>>1),y:(E<A?E:A)+(Math.abs(E-A)>>1)};e=e/a;h=e-L;b.trigger("zoom",f,C(f,s),h);L=e}}u==F&&b.trigger("pointerMove",k,n(k,s.x,s.y),j(k.x-w.x,k.y-
w.y));I&&b.trigger("pointerMoveMulti",k,n(k,s.x,s.y))}w=n(k)}}function m(e){var f=e.target?e.target:e.srcElement;if(f&&f===d){f=t(e,"changedTouches");var h=n(f,s.x,s.y);k=t(e);if(!k){u===z&&b.trigger("pointerTap",f,h);b.trigger("pointerUp",f,h);r=null}I&&b.trigger("pointerUpMulti",f,h)}}c=COG.extend({detailed:false,inertia:false},c);var x=20,D=7,G=0,z=1,F=2,H=3,s,u,r,k,a,w,I=c.detailed,L=1;c.binder("touchstart",q,false);c.binder("touchmove",y,false);c.binder("touchend",m,false);COG.info("initialized touch handler");
return{unbind:function(){c.unbinder("touchstart",q,false);c.unbinder("touchmove",y,false);c.unbinder("touchend",m,false)}}},checks:{touch:true}});return{register:i,watch:function(d,b,c){b=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},b);capabilities=COG.extend({touch:"ontouchstart"in window},c);if(!b.observable){COG.info("creating observable");b.observable=COG.observable({});globalOpts=b}b.binder=b.isIE?g:v(b.bindToBody);b.unbinder=b.isIE?o:B(b.bindToBody);
c=b.types;for(var p=capabilities,n=[],t=K.length;t--;){var q=K[t],y=!c||c.indexOf(q.type)>=0,m=true,x;for(x in q.checks){var D=q.checks[x];COG.info("checking "+x+" capability. require: "+D+", capability = "+p[x]);m=m&&D===p[x]}if(y&&m)n[n.length]=q.handler}return new N(d,n,b)}}}();
