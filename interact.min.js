COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var t=arguments[0]||{},A,f=1,m=arguments.length;f<m;f++)if((A=arguments[f])!==null)for(var j in A){var i=A[j];if(t!==i)if(i!==undefined)t[j]=i}return t};
(function(){function t(f,m){var j=f.obsHandlers;j[m]||(j[m]=[]);return j[m]}var A=0;COG.observable=function(f){if(!f)return null;if(!f.obsHandlers)f.obsHandlers={};if(!(f.bind||f.trigger||f.unbind)){f.bind=function(m,j){var i="callback"+A++;t(f,m).unshift({fn:j,id:i});return i};f.trigger=function(m){var j=t(f,m),i={cancel:false,name:m,tickCount:(new Date).getTime()},k;if(!j)return null;k=Array.prototype.slice.call(arguments,1);f.eventInterceptor&&f.eventInterceptor(m,i,k);k.unshift(i);for(var w=j.length;w--&&
!i.cancel;)j[w].fn.apply(self,k);return i};f.unbind=function(m,j){if(typeof m==="undefined")f.obsHandlers={};else for(var i=t(f,m),k=0;i&&k<i.length;k++)if(i[k].id===j){i.splice(k,1);break}return f}}return f}})();
(function(){function t(i){return typeof console!=="undefined"?function(){console[i](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var A=window.console&&window.console.markTimeline,f=t("error"),m=t("info"),j=function(){return A?function(i,k){console.markTimeline(i+(k?": "+((new Date).getTime()-k)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:t("debug"),info:m,warn:t("warn"),error:f,exception:function(i){if(f)for(var k in i)m("ERROR DETAIL: "+k+
": "+i[k])}})})();
INTERACT=function(){function t(c){return function(d,b,n){(n?n:c?document.body:document).addEventListener(d,b,false)}}function A(c){return function(d,b,n){(n?n:c?document.body:document).removeEventListener(d,b,false)}}function f(c,d,b){(b?b:document).attachEvent("on"+c,d)}function m(c,d,b){(b?b:document).detachEvent("on"+c,d)}function j(c,d){return{x:c?c:0,y:d?d:0,count:1}}function i(c,d){K.push(COG.extend({handler:null,checks:{},type:c},d))}function k(c){var d=0,b=0;if(c.offsetParent){do{d+=c.offsetLeft;
b+=c.offsetTop;c=c.offsetParent}while(c)}return{x:d,y:b}}function w(c,d){for(var b=c.target?c.target:c.srcElement;b&&b.nodeName&&b.nodeName.toUpperCase()!="CANVAS";)b=b.parentNode;return b&&b===d}function I(c,d){return{x:c.x-(d?d.x:0),y:c.y-(d?d.y:0)}}function N(c){if(c.preventDefault){c.preventDefault();c.stopPropagation()}else c.cancelBubble&&c.cancelBubble()}var K=[],O=function(c,d,b){function n(o,x,E,B){l.trigger("pan",B.x,B.y)}b=COG.extend({binder:null,unbinder:null,observable:null},b);for(var l=
b.observable,s=[],p={bind:function(){return l.bind.apply(null,arguments)},pannable:function(o){COG.extend({inertia:true},o);l.bind("pointerMove",n);return p},unbind:function(){l.unbind();for(var o=0;o<s.length;o++)s[o].unbind();return p}},y=0;y<d.length;y++)s.push(d[y](c,l,b));return p};i("pointer",{handler:function(c,d,b){function n(a){if(w(a,c))if(B=y(a)){c.style.cursor="move";N(a);u=a.pageX?a.pageX:a.screenX;q=a.pageY?a.pageY:a.screenY;C=j(u,q);G=k(c);d.trigger("pointerDown",C,I(C,G))}}function l(a){F=
a.pageX?a.pageX:a.screenX;r=a.pageY?a.pageY:a.screenY;B&&w(a,c)&&o("pointerMove")}function s(a){if(B&&y(a)){B=false;if(w(a,c)){c.style.cursor="default";o("pointerUp")}}}function p(a){if(w(a,c)){var v;a=a||window.event;if(a.detail)v=a.axis===2?-a.detail*x:0;else{v=a.wheelDeltaY?a.wheelDeltaY:a.wheelDelta;if(window.opera)v=-v}if(v!==0){var H=j(F,r);d.trigger("zoom",H,I(H,k(c)),v/E,"wheel");N(a);a.returnValue=false}}}function y(a){a=a||window.event;return(a.which||a.button)==1}function o(a){var v=j(F,
r);d.trigger(a,v,I(v,G),j(F-u,r-q));u=F;q=r}b=COG.extend({inertia:false},b);var x=120,E=x*8,B=false,C,G,F,r,u,q;b.binder("mousedown",n,false);b.binder("mousemove",l,false);b.binder("mouseup",s,false);b.binder("click",function(a){if(w(a,c)){a=j(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);d.trigger("tap",a,I(a,k(c)))}},false);b.binder("dblclick",function(a){COG.info("captured double click");if(w(a,c)){a=j(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);COG.info("captured double click + target matched");
d.trigger("doubleTap",a,I(a,k(c)))}},false);b.binder("mousewheel",p,document);b.binder("DOMMouseScroll",p,document);return{unbind:function(){b.unbinder("mousedown",n,false);b.unbinder("mousemove",l,false);b.unbinder("mouseup",s,false);b.unbinder("mousewheel",p,document);b.unbinder("DOMMouseScroll",p,document)}}},checks:{touch:false}});i("pointer",{handler:function(c,d,b){function n(e){if(e.count<2)return 0;var g=e.x-e.next.x;e=e.y-e.next.y;return~~Math.sqrt(g*g+e*e)}function l(e,g,h){g=g?g:0;h=h?
h:0;for(var D={x:e.x-g,y:e.y-h,id:e.id,count:e.count},z=D;e.next;){e=e.next;z=z.next={x:e.x-g,y:e.y-h,id:e.id}}return D}function s(e,g){var h=e[g?g:"touches"],D,z;if(h.length===0)return null;z=D={x:h[0].pageX,y:h[0].pageY,id:h[0].identifier,count:h.length};for(var J=1,P=h.length;J<P;J++)z=z.next={x:h[J].pageX,y:h[J].pageY,id:h[J].identifier};return D}function p(e){if(w(e,c)){r=k(c);var g=s(e,"changedTouches"),h=l(g,r.x,r.y);if(!q){u=C;d.trigger("pointerDown",g,h)}L&&d.trigger("pointerDownMulti",g,
h);q=s(e);if(q.count>1)v=n(q);M=1;H=l(q)}}function y(e){if(w(e,c)){e.preventDefault();a=s(e);if(u==C)u=Math.abs(q.x-a.x)>E||Math.abs(q.y-a.y)>E?B:C;if(u!=C){u=a.count>1?F:G;if(u==F)if(q.count===1){q=l(a);v=n(q)}else{e=n(a);if(Math.abs(v-e)<x)u=G;else{var g;g=a.x;var h=a.next.x,D=a.y,z=a.next.y;g={x:(g<h?g:h)+(Math.abs(g-h)>>1),y:(D<z?D:z)+(Math.abs(D-z)>>1)};e=e/v;h=e-M;d.trigger("zoom",g,I(g,r),h,"pinch");M=e}}u==G&&d.trigger("pointerMove",a,l(a,r.x,r.y),j(a.x-H.x,a.y-H.y));L&&d.trigger("pointerMoveMulti",
a,l(a,r.x,r.y))}H=l(a)}}function o(e){if(w(e,c)){var g=s(e,"changedTouches"),h=l(g,r.x,r.y);a=s(e);if(!a){u===C&&d.trigger("pointerTap",g,h);d.trigger("pointerUp",g,h);q=null}L&&d.trigger("pointerUpMulti",g,h)}}b=COG.extend({detailed:false,inertia:false},b);var x=20,E=7,B=0,C=1,G=2,F=3,r,u,q,a,v,H,L=b.detailed,M=1;b.binder("touchstart",p,false);b.binder("touchmove",y,false);b.binder("touchend",o,false);COG.info("initialized touch handler");return{unbind:function(){b.unbinder("touchstart",p,false);
b.unbinder("touchmove",y,false);b.unbinder("touchend",o,false)}}},checks:{touch:true}});return{register:i,watch:function(c,d,b){d=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},d);capabilities=COG.extend({touch:"ontouchstart"in window},b);if(!d.observable){COG.info("creating observable");d.observable=COG.observable({});globalOpts=d}d.binder=d.isIE?f:t(d.bindToBody);d.unbinder=d.isIE?m:A(d.bindToBody);b=d.types;for(var n=capabilities,l=[],s=K.length;s--;){var p=
K[s],y=!b||b.indexOf(p.type)>=0,o=true,x;for(x in p.checks){var E=p.checks[x];COG.info("checking "+x+" capability. require: "+E+", capability = "+n[x]);o=o&&E===n[x]}if(y&&o)l[l.length]=p.handler}return new O(c,l,d)}}}();
