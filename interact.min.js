COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var u=arguments[0]||{},A,h=1,n=arguments.length;h<n;h++)if((A=arguments[h])!==null)for(var k in A){var j=A[k];if(u!==j)if(j!==undefined)u[k]=j}return u};
(function(){function u(h,n){var k=h.obsHandlers;k[n]||(k[n]=[]);return k[n]}var A=0;COG.observable=function(h){if(!h)return null;if(!h.obsHandlers)h.obsHandlers={};if(!(h.bind||h.trigger||h.unbind)){h.bind=function(n,k){var j="callback"+A++;u(h,n).unshift({fn:k,id:j});return j};h.trigger=function(n){var k=u(h,n),j={cancel:false,name:n,tickCount:(new Date).getTime()},l;if(!k)return null;l=Array.prototype.slice.call(arguments,1);h.eventInterceptor&&h.eventInterceptor(n,j,l);l.unshift(j);for(var B=k.length;B--&&
!j.cancel;)k[B].fn.apply(self,l);return j};h.unbind=function(n,k){if(typeof n==="undefined")h.obsHandlers={};else for(var j=u(h,n),l=0;j&&l<j.length;l++)if(j[l].id===k){j.splice(l,1);break}return h}}return h}})();
(function(){function u(j){return typeof console!=="undefined"?function(){console[j](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var A=window.console&&window.console.markTimeline,h=u("error"),n=u("info"),k=function(){return A?function(j,l){console.markTimeline(j+(l?": "+((new Date).getTime()-l)+"ms":""))}:function(){}}();COG.extend(COG,{trace:k,debug:u("debug"),info:n,warn:u("warn"),error:h,exception:function(j){if(h)for(var l in j)n("ERROR DETAIL: "+l+
": "+j[l])}})})();
INTERACT=function(){function u(c){return function(b,d,o){(o?o:c?document.body:document).addEventListener(b,d,false)}}function A(c){return function(b,d,o){(o?o:c?document.body:document).removeEventListener(b,d,false)}}function h(c,b,d){(d?d:document).attachEvent("on"+c,b)}function n(c,b,d){(d?d:document).detachEvent("on"+c,b)}function k(c,b){return{x:c?c:0,y:b?b:0,count:1}}function j(c,b){J.push(COG.extend({handler:null,checks:{},type:c},b))}function l(c){var b=0,d=0;if(c.offsetParent){do{b+=c.offsetLeft;
d+=c.offsetTop;c=c.offsetParent}while(c)}return{x:b,y:d}}function B(c,b){return{x:c.x-(b?b.x:0),y:c.y-(b?b.y:0)}}function M(c){if(c.preventDefault){c.preventDefault();c.stopPropagation()}else c.cancelBubble&&c.cancelBubble()}var J=[],N=function(c,b,d){function o(p,y,w,C){m.trigger("pan",C.x,C.y)}d=COG.extend({binder:null,unbinder:null,observable:null},d);for(var m=d.observable,t=[],q={bind:function(){return m.bind.apply(null,arguments)},pannable:function(p){COG.extend({inertia:true},p);m.bind("pointerMove",
o);return q},unbind:function(){m.unbind();for(var p=0;p<t.length;p++)t[p].unbind();return q}},x=0;x<b.length;x++)t.push(b[x](c,m,d));return q};j("pointer",{handler:function(c,b,d){function o(a){var g=a.target?a.target:a.srcElement;if(w||g&&g===c)if(C=a.button===0){g.style.cursor="move";M(a);v=a.pageX?a.pageX:a.screenX;r=a.pageY?a.pageY:a.screenY;D=k(v,r);G=l(c);b.trigger("pointerDown",D,B(D,G))}}function m(a){var g=a.target?a.target:a.srcElement;F=a.pageX?a.pageX:a.screenX;s=a.pageY?a.pageY:a.screenY;
if(C&&(w||g&&g===c))x("pointerMove")}function t(a){var g=a.target?a.target:a.srcElement;if(C&&a.button===0){C=false;if(w||g&&g===c){g.style.cursor="default";x("pointerUp")}}}function q(a){var g=a.target?a.target:a.srcElement;if(w||g&&g===c){g=a.detail?a.axis===2?-a.detail*p:0:a.wheelDeltaY;if(g!==0){var H=k(F,s);b.trigger("zoom",H,B(H,l(c)),g/y);M(a)}}}function x(a){var g=k(F,s);b.trigger(a,g,B(g,G),k(F-v,s-r));v=F;r=s}d=COG.extend({inertia:false},d);var p=120,y=p*8,w=typeof FlashCanvas!="undefined",
C=false,D,G,F,s,v,r;d.binder("mousedown",o,false);d.binder("mousemove",m,false);d.binder("mouseup",t,false);d.binder("click",function(a){var g=a.target?a.target:a.srcElement;if(w||g&&g===c){a=k(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("tap",a,B(a,l(c)))}},false);d.binder("dblclick",function(a){var g=a.target?a.target:a.srcElement;if(w||g&&g===c){a=k(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("doubleTap",a,B(a,l(c)))}},false);d.binder("mousewheel",q,window);
d.binder("DOMMouseScroll",q,window);return{unbind:function(){d.unbinder("mousedown",o,false);d.unbinder("mousemove",m,false);d.unbinder("mouseup",t,false);d.unbinder("mousewheel",q,window);d.unbinder("DOMMouseScroll",q,window)}}},checks:{touch:false}});j("pointer",{handler:function(c,b,d){function o(e){if(e.count<2)return 0;var f=e.x-e.next.x;e=e.y-e.next.y;return~~Math.sqrt(f*f+e*e)}function m(e,f,i){f=f?f:0;i=i?i:0;for(var E={x:e.x-f,y:e.y-i,id:e.id,count:e.count},z=E;e.next;){e=e.next;z=z.next=
{x:e.x-f,y:e.y-i,id:e.id}}return E}function t(e,f){var i=e[f?f:"touches"],E,z;if(i.length===0)return null;z=E={x:i[0].pageX,y:i[0].pageY,id:i[0].identifier,count:i.length};for(var I=1,O=i.length;I<O;I++)z=z.next={x:i[I].pageX,y:i[I].pageY,id:i[I].identifier};return E}function q(e){var f=e.target?e.target:e.srcElement;if(f&&f===c){s=l(c);f=t(e,"changedTouches");var i=m(f,s.x,s.y);if(!r){v=D;b.trigger("pointerDown",f,i)}K&&b.trigger("pointerDownMulti",f,i);r=t(e);if(r.count>1)g=o(r);L=1;H=m(r)}}function x(e){var f=
e.target?e.target:e.srcElement;if(f&&f===c){e.preventDefault();a=t(e);if(v==D)v=Math.abs(r.x-a.x)>w||Math.abs(r.y-a.y)>w?C:D;if(v!=D){v=a.count>1?F:G;if(v==F)if(r.count===1){r=m(a);g=o(r)}else{e=o(a);if(Math.abs(g-e)<y)v=G;else{f=a.x;var i=a.next.x,E=a.y,z=a.next.y;f={x:(f<i?f:i)+(Math.abs(f-i)>>1),y:(E<z?E:z)+(Math.abs(E-z)>>1)};e=e/g;i=e-L;b.trigger("zoom",f,B(f,s),i);L=e}}v==G&&b.trigger("pointerMove",a,m(a,s.x,s.y),k(a.x-H.x,a.y-H.y));K&&b.trigger("pointerMoveMulti",a,m(a,s.x,s.y))}H=m(a)}}function p(e){var f=
e.target?e.target:e.srcElement;if(f&&f===c){f=t(e,"changedTouches");var i=m(f,s.x,s.y);a=t(e);if(!a){v===D&&b.trigger("pointerTap",f,i);b.trigger("pointerUp",f,i);r=null}K&&b.trigger("pointerUpMulti",f,i)}}d=COG.extend({detailed:false,inertia:false},d);var y=20,w=7,C=0,D=1,G=2,F=3,s,v,r,a,g,H,K=d.detailed,L=1;d.binder("touchstart",q,false);d.binder("touchmove",x,false);d.binder("touchend",p,false);COG.info("initialized touch handler");return{unbind:function(){d.unbinder("touchstart",q,false);d.unbinder("touchmove",
x,false);d.unbinder("touchend",p,false)}}},checks:{touch:true}});return{register:j,watch:function(c,b,d){b=COG.extend({bindToBody:false,observable:null,isIE:typeof window.attachEvent!="undefined",types:null},b);capabilities=COG.extend({touch:"ontouchstart"in window},d);if(!b.observable){COG.info("creating observable");b.observable=COG.observable({});globalOpts=b}b.binder=b.isIE?h:u(b.bindToBody);b.unbinder=b.isIE?n:A(b.bindToBody);d=b.types;for(var o=capabilities,m=[],t=J.length;t--;){var q=J[t],
x=!d||d.indexOf(q.type)>=0,p=true,y;for(y in q.checks){var w=q.checks[y];COG.info("checking "+y+" capability. require: "+w+", capability = "+o[y]);p=p&&w===o[y]}if(x&&p)m[m.length]=q.handler}return new N(c,m,b)}}}();
