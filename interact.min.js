COG=typeof COG!=="undefined"?COG:{};COG.extend=function(){for(var v=arguments[0]||{},A,g=1,n=arguments.length;g<n;g++)if((A=arguments[g])!==null)for(var j in A){var i=A[j];if(v!==i)if(i!==undefined)v[j]=i}return v};
(function(){function v(g,n){var j=g.obsHandlers;j[n]||(j[n]=[]);return j[n]}var A=0;COG.observable=function(g){if(!g)return null;if(!g.obsHandlers)g.obsHandlers={};if(!(g.bind||g.trigger||g.unbind)){g.bind=function(n,j){var i="callback"+A++;v(g,n).unshift({fn:j,id:i});return i};g.trigger=function(n){var j=v(g,n),i={cancel:false,name:n,tickCount:(new Date).getTime()},l;if(!j)return null;l=Array.prototype.slice.call(arguments,1);g.eventInterceptor&&g.eventInterceptor(n,i,l);l.unshift(i);for(var B=j.length;B--&&
!i.cancel;)j[B].fn.apply(self,l);return i};g.unbind=function(n,j){if(typeof n==="undefined")g.obsHandlers={};else for(var i=v(g,n),l=0;i&&l<i.length;l++)if(i[l].id===j){i.splice(l,1);break}return g}}return g}})();
(function(){function v(i){return typeof console!=="undefined"?function(){console[i](Array.prototype.slice.call(arguments,0).join(" "));return true}:function(){return false}}var A=window.console&&window.console.markTimeline,g=v("error"),n=v("info"),j=function(){return A?function(i,l){console.markTimeline(i+(l?": "+((new Date).getTime()-l)+"ms":""))}:function(){}}();COG.extend(COG,{trace:j,debug:v("debug"),info:n,warn:v("warn"),error:g,exception:function(i){if(g)for(var l in i)n("ERROR DETAIL: "+l+
": "+i[l])}})})();
INTERACT=function(){function v(d){return function(b,c,o){(o?o:d?document.body:document).addEventListener(b,c,false)}}function A(d){return function(b,c,o){(o?o:d?document.body:document).removeEventListener(b,c,false)}}function g(d,b,c){(c?c:document).attachEvent("on"+d,b)}function n(d,b,c){(c?c:document).detachEvent("on"+d,b)}function j(d,b){return{x:d?d:0,y:b?b:0,count:1}}function i(d,b){L.push(COG.extend({handler:null,checks:{},type:d},b))}function l(d){var b=0,c=0;if(d.offsetParent){do{b+=d.offsetLeft;
c+=d.offsetTop;d=d.offsetParent}while(d)}return{x:b,y:c}}function B(d,b){return{x:d.x-(b?b.x:0),y:d.y-(b?b.y:0)}}function M(d){if(d.preventDefault){d.preventDefault();d.stopPropagation()}else d.cancelBubble&&d.cancelBubble()}var L=[],N=function(d,b,c){function o(q,x,E,H){m.trigger("pan",H.x,H.y)}c=COG.extend({binder:null,unbinder:null,observable:null},c);for(var m=c.observable,s=[],r={bind:function(){return m.bind.apply(null,arguments)},pannable:function(q){COG.extend({inertia:true},q);m.bind("pointerMove",
o);return r},unbind:function(){m.unbind();for(var q=0;q<s.length;q++)s[q].unbind();return r}},t=0;t<b.length;t++)s.push(b[t](d,m,c));return r};i("pointer",{handler:function(d,b,c){function o(a){if(t(a))if(F=H||a.button===0){d.style.cursor="move";M(a);k=a.pageX?a.pageX:a.screenX;C=a.pageY?a.pageY:a.screenY;I=j(k,C);w=l(d);b.trigger("pointerDown",I,B(I,w))}}function m(a){u=a.pageX?a.pageX:a.screenX;p=a.pageY?a.pageY:a.screenY;F&&t(a)&&q("pointerMove")}function s(a){if(F&&a.button===0){F=false;if(t(a)){d.style.cursor=
"default";q("pointerUp")}}}function r(a){if(t(a)){var y;y=a.detail?a.axis===2?-a.detail*x:0:a.wheelDeltaY;if(y!==0){var J=j(u,p);b.trigger("zoom",J,B(J,l(d)),y/E);M(a)}}}function t(a){a=a.target?a.target:a.srcElement;if(G)a=a.parentNode;return a&&a===d}function q(a){var y=j(u,p);b.trigger(a,y,B(y,w),j(u-k,p-C));k=u;C=p}c=COG.extend({inertia:false},c);var x=120,E=x*8,H=c.isIE,G=typeof FlashCanvas!="undefined",F=false,I,w,u,p,k,C;c.binder("mousedown",o,false);c.binder("mousemove",m,false);c.binder("mouseup",
s,false);c.binder("click",function(a){if(t(a)){a=j(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("tap",a,B(a,l(d)))}},false);c.binder("dblclick",function(a){if(t(a)){a=j(a.pageX?a.pageX:a.screenX,a.pageY?a.pageY:a.screenY);b.trigger("doubleTap",a,B(a,l(d)))}},false);c.binder("mousewheel",r,window);c.binder("DOMMouseScroll",r,window);return{unbind:function(){c.unbinder("mousedown",o,false);c.unbinder("mousemove",m,false);c.unbinder("mouseup",s,false);c.unbinder("mousewheel",r,window);
c.unbinder("DOMMouseScroll",r,window)}}},checks:{touch:false}});i("pointer",{handler:function(d,b,c){function o(e){if(e.count<2)return 0;var f=e.x-e.next.x;e=e.y-e.next.y;return~~Math.sqrt(f*f+e*e)}function m(e,f,h){f=f?f:0;h=h?h:0;for(var D={x:e.x-f,y:e.y-h,id:e.id,count:e.count},z=D;e.next;){e=e.next;z=z.next={x:e.x-f,y:e.y-h,id:e.id}}return D}function s(e,f){var h=e[f?f:"touches"],D,z;if(h.length===0)return null;z=D={x:h[0].pageX,y:h[0].pageY,id:h[0].identifier,count:h.length};for(var K=1,O=h.length;K<
O;K++)z=z.next={x:h[K].pageX,y:h[K].pageY,id:h[K].identifier};return D}function r(e){var f=e.target?e.target:e.srcElement;if(f&&f===d){w=l(d);f=s(e,"changedTouches");var h=m(f,w.x,w.y);if(!p){u=G;b.trigger("pointerDown",f,h)}y&&b.trigger("pointerDownMulti",f,h);p=s(e);if(p.count>1)C=o(p);J=1;a=m(p)}}function t(e){var f=e.target?e.target:e.srcElement;if(f&&f===d){e.preventDefault();k=s(e);if(u==G)u=Math.abs(p.x-k.x)>E||Math.abs(p.y-k.y)>E?H:G;if(u!=G){u=k.count>1?I:F;if(u==I)if(p.count===1){p=m(k);
C=o(p)}else{e=o(k);if(Math.abs(C-e)<x)u=F;else{f=k.x;var h=k.next.x,D=k.y,z=k.next.y;f={x:(f<h?f:h)+(Math.abs(f-h)>>1),y:(D<z?D:z)+(Math.abs(D-z)>>1)};e=e/C;h=e-J;b.trigger("zoom",f,B(f,w),h);J=e}}u==F&&b.trigger("pointerMove",k,m(k,w.x,w.y),j(k.x-a.x,k.y-a.y));y&&b.trigger("pointerMoveMulti",k,m(k,w.x,w.y))}a=m(k)}}function q(e){var f=e.target?e.target:e.srcElement;if(f&&f===d){f=s(e,"changedTouches");var h=m(f,w.x,w.y);k=s(e);if(!k){u===G&&b.trigger("pointerTap",f,h);b.trigger("pointerUp",f,h);
p=null}y&&b.trigger("pointerUpMulti",f,h)}}c=COG.extend({detailed:false,inertia:false},c);var x=20,E=7,H=0,G=1,F=2,I=3,w,u,p,k,C,a,y=c.detailed,J=1;c.binder("touchstart",r,false);c.binder("touchmove",t,false);c.binder("touchend",q,false);COG.info("initialized touch handler");return{unbind:function(){c.unbinder("touchstart",r,false);c.unbinder("touchmove",t,false);c.unbinder("touchend",q,false)}}},checks:{touch:true}});return{register:i,watch:function(d,b,c){b=COG.extend({bindToBody:false,observable:null,
isIE:typeof window.attachEvent!="undefined",types:null},b);capabilities=COG.extend({touch:"ontouchstart"in window},c);if(!b.observable){COG.info("creating observable");b.observable=COG.observable({});globalOpts=b}b.binder=b.isIE?g:v(b.bindToBody);b.unbinder=b.isIE?n:A(b.bindToBody);c=b.types;for(var o=capabilities,m=[],s=L.length;s--;){var r=L[s],t=!c||c.indexOf(r.type)>=0,q=true,x;for(x in r.checks){var E=r.checks[x];COG.info("checking "+x+" capability. require: "+E+", capability = "+o[x]);q=q&&
E===o[x]}if(t&&q)m[m.length]=r.handler}return new N(d,m,b)}}}();
